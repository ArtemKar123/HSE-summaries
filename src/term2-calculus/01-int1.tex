\Subsection{Первообразная и неопределенный интеграл}
\begin{definition}
    $f\!: \langle a, b \rangle \to \R$. Функция  $F\!: \langle a, b \rangle \to \R$ --- первообразная функции  $f$, если  $F'(x) = f(x) \forall x \in \langle a, b \rangle$
\end{definition}
\begin{theorem}
    Непрерывная на промежутке функция имеет первообразную.
\end{theorem}
\begin{proof}
    Позже.
\end{proof}
\begin{remark}
    $\text{sign}\ x = \begin{cases} 1 & \text{ если } x > 0 \\ 0 & \text{ если } x = 0 \\ -1 & \text{ если }  x < 0 \end{cases}$. Не имеет первообразной.
\end{remark}
\begin{proof}
    От противного: пусть нашлась $F\!: \langle a, b \rangle \to \R$ и $F'(x) = sign(x)$.
    
    Тогда воспользуемся теоремой Дарбу для $F$ на отрезке $[0; 1]$.
    
    Пусть $k = \frac{1}{2} \in (\text{sign}\ (0), \text{sign}\ (1))$. Значит $\exists c \in (0, 1) \!: F'(c) = k = \frac{1}{2}$. Противоречие.
\end{proof}
\begin{theorem}
    $f, F\!: \langle a, b \rangle \to \R$ и  $F$ --- первообразная для  $f$. Тогда: 
     \begin{enumerate}
         \item $F+C$ --- первообразная для  $f$.
         \item  Если  $\Phi\!: \langle a, b \rangle \to \R$ --- первообразная для  $f$, то  $\Phi = F + C$. 
    \end{enumerate}
\end{theorem}
\begin{proof}
    \slashn
    \begin{enumerate}
        \item $(F(x) + C)' = F'(x) + C' = f(x)$
        \item $(\Phi(x) - F(x))' = \Phi'(x) - F'(x) = f(x) - f(x) = 0 \Rightarrow (\Phi - F)' \equiv 0 \implies \Phi -F$ --- константа. 
    \end{enumerate}
\end{proof}
\begin{definition}
    Неопределённый интеграл --- множество всех первообразных.

    $\int f(x)\,dx = \{F\!: F \text{ --- первообразная f}\}$. Но мы будем записывать $\int f(x)\,dx = F(x) + C$
\end{definition}

\textbf{Табличка интегралов.}
\begin{enumerate}
    \item $\int 0\,dx = C$.
    \item $\int x^p\,dx = \frac{x^{p+1}}{p+1}+C$, при $p \neq -1$.
    \item  $\int \frac{dx}{x} = \ln |x| + C$.
    \item $\int a^x\,dx = \frac{a^x}{\ln a} + c$, при $a > 0, a \neq 1$.
    \item  $\int \sin x\,dx = - \cos x + C$.
    \item  $\int \cos x\,dx = \sin x + C$.
    \item $\int \frac{dx}{\cos^2 x} = \tg x + C$.
    \item $\int \frac{dx}{\sin^2 x} = -\ctg x + C$ 
    \item $\int \frac{dx}{\sqrt{1-x^2}} = \arcsin x + C$.
    \item $\int \frac{dx}{1+x^2} = \arctg x + C$.
    \item $\int \frac{dx}{\sqrt{x^2 \pm 1}} = \ln |x+\sqrt{x^2 \pm 1}| + C$. 
    \item $\int \frac{dx}{1-x^2} = \frac{1}{2} \ln |\frac{1+x}{1-x}| + C$.
\end{enumerate}
\begin{proof}
    Для 3. Если $x > 0$  $\int \frac{dx}{x} = \ln x + C$ . Если $x < 0$  $\int \frac{dx}{x} = \ln(-x) + C$, то есть $(\ln (-x))' = (\frac{1}{-x}) (-x)' = \frac{-1}{x}$.

    Для 11. $(\ln |x+\sqrt{x^2 \pm 1}|)' = \frac{1}{x + \sqrt{x^2 \pm 1}}(x + \sqrt{x^2 \pm 1})' = \frac{1 + \frac{x}{\sqrt{x^2 \pm 1}}}{x + \sqrt{x^2}} = \frac{\frac{\sqrt{x^2 pm 1} + x}{\sqrt{x^2 \pm 1}}}{\sqrt{x^2 \pm 1} + x} = \frac{1}{\sqrt{x^2 \pm 1}}$

    Для 13. $(\frac{1}{2}(\ln |1+x| - \ln |1-x|))' = \frac{1}{2}(\frac{1}{1+x} + \frac{1}{1-x}) = \frac{1}{1-x^2}$
\end{proof}
\begin{remark}
    $A + B \coloneqq \{a+b\!: a \in A, b \in B\}$,  $cA \coloneqq \{ca\!: a \in A\}$.

    $\int f(x)\,dx + \int g(x)\,dx = \{F+C\} + \{G+\widetilde{C}\} = \{F+G+C\}$.
\end{remark}
\begin{theorem}[Арифметические действия с неопределенными интегралами]
    Пусть $f, g\!: \langle a, b \rangle \to \R$ имеют первообразные. Тогда:
     \begin{enumerate}
         \item $f+g$ имеет первообразную и  $\int (f+g)\,dx = \int f\,dx + \int g\,dx$
         \item $\alpha f$ имеет первообразную и  $\int \alpha f\,dx = \alpha \int f\,dx$
    \end{enumerate}
\end{theorem}
\begin{proof}
    Пусть $F$ и  $G$ первообразные для  $f$ и  $g$. 
     \begin{enumerate}
         \item Тогда $F+G$ --- первообразная для  $f+g$. Тогда  $\int(f+g) = F+G+C = \int f + \int g$.
         \item Тогда  $\alpha F$ --- первообразная для  $\alpha f \implies \int \alpha F = \alpha F + C = \alpha(F + \frac{C}{\alpha}) = \alpha \int f$.
    \end{enumerate}
\end{proof}
\begin{consequence}[Линейность неопрделенного интеграла]
    $f, g\!:\langle a, b\rangle \to \R$ имеют первообразную $\alpha, \beta \in \R$,  $|\alpha| + |\beta| \neq 0$. Тогда  $\int(\alpha f+ \beta g) = \alpha \int f + \beta \int g$. 
\end{consequence}
\begin{proof}
    Прямое следствие из теоремы выше.
\end{proof}
\begin{theorem}[Теорема о замене переменной в непопределенном интеграле]
    $f\!: \langle a, b \rangle \to \R, \varphi\!:\langle c, d \rangle \to \langle a, b \rangle$,  $f$ имеет первообразную  $F$.  $\varphi$ дифференцируемая. Тогда  $\int f(\varphi(t)) \varphi'(t)\,dt = F(\varphi(t)) + C$.
\end{theorem}
\begin{proof}
    Надо проверить, что $F(\varphi(t))$ --- первообразная для  $f(\varphi(t))\varphi'(t)$.  \[
        (F(\varphi(t)))' = F'(\varphi(t))\cdot \varphi'(t) = f(\varphi(t))\varphi(t).
    .\] 
\end{proof}
\begin{consequence}
    $\int f(\alpha x + \beta)\,dx = \frac{1}{\alpha}F(\alpha x + \beta)+C$
\end{consequence}
\begin{proof}
    $\int \alpha f(\alpha x + \beta dx) = F(\alpha x + \beta) + C$. И делим обе части на  $\alpha$.
\end{proof}
\begin{theorem}[Форумла интегрирования по частям]
    $f, g\!: \langle a, b \rangle \to \R$, дифференцируемые,  $f'g$ имеет первообразную.

    Тогда  $fg'$ имеет первообразную и  $\int fg' = fg - \int f'g$
\end{theorem}
\begin{proof}
    $H$ --- первообразная для  $f'g$. Тогда  $H' = f'g$.

    Надо доказать, что  $fg - H$ --- первообразная для $fg'$.

    $(fg - H)' = f'g + gh' - H' = f'g + fg' - f'g = fg'$. 
\end{proof}
\Subsection{Определенный интеграл}
%BEGIN TICKET 01
Пусть $\mathcal{F}$ --- совокупность (множество) ограниченных плоских фигур. 
\begin{definition}
    Площадь: $\sigma\!: \mathcal{F} \to [0; +\infty)$, причём 
     \begin{enumerate}
         \item $\sigma([a; b] \times [c, d]) = (b - a)(d - c)$
         \item (Аддитивность).  $\forall E_1, E_2 \in \mathcal{F}\!: E_1 \cap E_2 = \emptyset \Rightarrow \sigma(E_1 \cup E_2) = \sigma(E_1) + \sigma(E_2)$
    \end{enumerate}
\end{definition}
\begin{property}[Монотонность площади]
    $\forall E, \widetilde{E}\!: E \subset \widetilde{E} \Rightarrow \sigma(E) \le \sigma(\widetilde{E})$.
\end{property}
\begin{proof}
    $\widetilde{E} = E \cup (\widetilde{E} \setminus E) \Rightarrow \sigma(\widetilde{E}) = \sigma(E) + \sigma(\widetilde{E} \setminus E)$.
\end{proof}
\begin{definition}
    Псевдоплощадь: $\sigma\!: \mathcal{F} \to [0; +\infty)$, причём
     \begin{enumerate}
         \item $\sigma([a; b] \times [c, d]) = (b - a)(d - c)$,
         \item $\forall E, \widetilde{E} \in \mathcal{F}\!: E \subset \widetilde{E} \Rightarrow \sigma(E) \le \sigma(\widetilde{E})$, 
         \item Разобьем $E$ вертикальной или горизонтальной прямой, в том числе теми прямыми, которые правее или левее $E$. Тогда  $E = E_- \cup E_+, E_- \cap E_+ = \emptyset$ и  $\sigma(E) = \sigma(E_-) + \sigma(E_+)$.
    \end{enumerate}
\end{definition}
\begin{properties}
    \begin{enumerate}
        \item Подмножество вертикального или горизонтального отрезка имеет нулевую площадь.
        \item В определении $E_-$ и  $E_+$ неважно  куда относить точки из  $l$.
            \begin{proof}
            	Пусть $\widetilde{E} = E_- \cup (E \cap l) = (E_- \setminus l) \cup (E \cap l)$.
            	
            	Тогда $ \sigma(\widetilde{E}) = \sigma(E_- \cup (E \cap l)) = \sigma(E_- \setminus l) + \underbrace{\sigma(E \cap l)}_{=0} \Rightarrow$ вообще не имеет разницы куда относить точки из $l$.
            \end{proof}
    \end{enumerate}
\end{properties}
%END TICKET 01
%BEGIN TICKET 02
\begin{example}
    \slashn
     \begin{enumerate}
         \item $\sigma_1(E) = \inf \left\{\sum\limits_{k=1}^n |P_k|\!: P_k\text{ --- прямоугольник}, \bigcup\limits_{k=1}^n P_k \supset E\right\}$.
         \item $\sigma_2(E) = \inf \left\{\sum\limits_{k=1}^\infty |P_k|\!: P_k\text{ --- прямоугольник}, \bigcup\limits_{k=1}^\infty P_k  \supset E\right\}$.
    \end{enumerate}
\end{example}
\begin{exerc}
    \slashn
    \begin{enumerate}
        \item Доказать, что $\forall E\ \ \sigma_1(E) \ge \sigma_2(E)$.
        \item $E = \left([0, 1] \cap \Q\right) \times \left([0, 1] \cap \Q\right)$. Доказать, что  $\sigma_1(E) = 1, \sigma_2(E) = 0$.
    \end{enumerate}
\end{exerc}
\begin{theorem}
    \slashn
     \begin{enumerate}
         \item $\sigma_1$ --- квазиплощадь.
         \item Если  $E'$ --- сдвиг  $E$, то  $\sigma_1(E) = \sigma_1(E')$.
     \end{enumerate}
\end{theorem}
\begin{proof}
    \slashn
    \begin{enumerate}
        \item[2.] $E'$ --- сдвиг  $E$ на вектор  $v$. Пусть  $P_k$ --- покрытие  $E \iff P'_k$ --- покрытие  $E'$. Знаем, что площади прямоугольников не меняются при сдвиге, а значит:
            
            $\sigma_1(E) = \inf\{\sum\limits_{k=1}^n|P_k|\} = \inf\{\sum |P'_k|\} = \sigma_1(E')$.
        \item[1.] $\Rightarrow$ монотонность. Пусть есть  $E \subset \widetilde{E}$. Тогда возьмем покрытие  $P_k$ для  $\widetilde{E}$.  $E \subset \widetilde{E} \subset \bigcup\limits_{k=1}^n P_k$. 

		А теперь заметим, что $\sigma_1$ ---  $\inf$, и любое покрытие для $\widetilde{E}$ является покрытием и для $E$, т.е. все суммы из $\sigma_1(\widetilde{E})$ есть в $\sigma_1(E)$, а значит $\sigma_1(E) \le \sigma_1(\widetilde{E})$ как инфинум по более широкому множеству. 

        \item[1'.] Докажем теперь аддитивность. 

            <<$\le$>>: $\sigma_1(E) = \sigma_1(E_-) + \sigma_1(E_+)$. Пусть $P_k$ --- покрытие  $E_-$,  $Q_j$ --- покрытие  $E_+$.
            
            Тогда $\bigcup\limits_{k=1}^n P_k \cup \bigcup\limits_{j=1}^n Q_j \supset E_- \cup E_+ = E$.
            
            А значит  $\sigma_1(E) \le \inf \left\{ \sum\limits_{k=1}^n |P_k| + \sum\limits_{j=1}^n |Q_j|\right\} = \inf\{\sum |P_k|\} + \inf\{\sum |Q_j|\} = \sigma_1(E_-) + \sigma(E_+)$. Заметим, Что переход с разделением инфинумов  возможен, так как $P$ и  $Q$ выбираются независимо.

	    <<$\ge$>>: Пусть $P_k$ --- покрытие  $E$. Тогда можно пересечь прямой (покрытие и само $E$) и разбить $P_k$ на $P_k^-$ и $P_k^+$, а тогда: $|P_k| = |P^-_k| + |P^+_k|$,  $\sum |P_k| = \sum |P^-_k| + \sum |P^+_k|$.
	    
	    $\sum |P_k^-| \ge \sigma_1(E_-), \sum |P_k^+| \ge \sigma_1(E^+) \Rightarrow \sum |P_k| \ge \sigma_1(E_-) + \sigma_1(E_+)$ для любого покрытия $P_k$, а значит и $\sigma_1(E) \ge \sigma_1(E_-) + \sigma_1(E_+)$

	    Таким образом $\sigma_1(E) = \sigma_1(E_-) + \sigma_1(E_+)$
        \item[1''.] Проверим, что сама площадь прямоугольника не сломалась: $\sigma_1([a, b] \times [c, d]) = (b-a)(d-c)$. Заметим, что  $\sigma_1(P) \le |P|$, т.к. прямоугольник можно покрыть им самим.

		Чтобы доказать $\sigma_1(P) \ge |P|$, посмотрим на $P_k$. Проведем прямые содержащие все стороны прямоугольников из покрытия (и $P$). Заметим, что такими прямыми каждый прямоугольник разбивается на подпрямоугольники, сумма площадей которых равна площади исходного прямоугольника. Тогда заметим, что и площадь $P$ это сумма <<кусочков из нарезки>> $P$, и некоторые части разбиения встречаются в  $P_k$ несколько раз. А значит выкинув все лишнее мы как раз получим  $|P|$, а значит  $\sigma_1(P) \ge |P|$.
		
		Формально: Если $\bigcup\limits_{k=1}^n P_k \supset P$, то $\sum\limits_{k=1}^n |P_k| \ge P \Rightarrow \inf \left\{\sum\limits_{k=1}^n |P_k|\right\} \ge |P|$.
		
		Таким образом $\sigma_1(P) = |P|$.
    \end{enumerate}
\end{proof}
%END TICKET 02
%BEGIN TICKET 03
\begin{definition}
    Пусть $f\!: [a, b] \to \R$. Тогда  $f_+, f_-\!: [a, b] \to [0; +\inf)$. Причем  $f_+(x) = \max\{f(x), 0\}$,  $f_- = \max\{-f(x), 0\}$. $f_+$ --- положительная составляющая, а $f_-$ --- отрицательная составляющая.
\end{definition}
\begin{properties}
    \begin{enumerate}
        \item $f = f_+ - f_-$.
        \item  $|f| = f_+ + f_-$
        \item  $f_+ = \frac{f + |f|}{2}$, $f_- = \frac{|f| - f}{2}$. (Сложили и вычли первые два свойства)
        \item Если $f \in C([a, b])$ , то  $f_{\pm} \in C([a, b])$. (Видно из 3-го пункта)
    \end{enumerate}
\end{properties}

\begin{definition}
	Пусть $f\!: [a, b] \to [0; +\infty)$.

    Тогда подграфик $P_f([a; b]) \coloneqq \{(x, y) \in \R^2 \mid x \in [a, b], 0 \le y \le f(x)\}$.
    Подграфик может быть взят и от какого-то подотрезка области определения функции!
\end{definition}
%END TICKET 03
%BEGIN TICKET 04
\begin{definition}
    Пусть $f \in C([a, b])$. Зафиксируем произвольную квазиплощадь $\sigma$. Тогда
    Определённый интеграл: $\int\limits_a^b f = \int\limits_a^b f(x) dx = \sigma(P_{f_+}([a; b])) - \sigma(P_{f_-}([a; b]))$.

    Определение корректно, поскольку, раз функция непрерывна, то и составляющие непрерывны на отрезке, значит ограничены, значит под $\sigma$ ограниченные множества, на которых $\sigma$ определена. А позже проверим, что результат не зависит и от выбора $\sigma$.
\end{definition}
\begin{properties}
    \begin{enumerate}
    \item $\int\limits_a^a f = 0$. (Площадь отрезка = 0)
	\item $\int\limits_a^b c = c(b-a), c \ge 0$ (для отрицательных будет следовать из пунктов ниже)
            \begin{proof}
                По графику очевидно :)
            \end{proof}
        \item $f \ge 0 \Rightarrow \int\limits_a^b = \sigma(P_f)$.
        \item $\int\limits_a^b (-f) = -\int\limits_a^b f$.
             \begin{proof}
		     $(-f)_+ = \max\{-f, 0\} = f_-$.  $(-f)_- = \max\{f, 0\} = f+$, откуда $\int_a^b (-f) = \sigma(P_{(-f)_+}) - \sigma(P_{(-f)_-}) = \sigma(P_{f_-}) - \sigma(P_{f_+}) = -\int_a^b f$
            \end{proof}
        \item $f \ge 0 \land \int\limits_a^b f = 0 \land a < b \Rightarrow f = 0$.
            \begin{proof}
                От противного. Пусть $\exists c \in [a, b]\!: f(c) > 0$. Тогда, возьмем $\eps \coloneqq \frac{f(c)}{2}, \delta$ из определения непрерывности в точке $c$. Если  $x \in (c - \delta, c + \delta)$, то  $f(x) \in (f(c) - \eps, f(c) + \eps) = (\frac{f(c)}{2}; \frac{3f(c)}{2}) \Rightarrow f(x) \ge \frac{f(c)}{2}$ при $x \in (c - \delta; c + \delta) \Rightarrow P_f \supset [c-\frac{\delta}{2}; c + \frac{\delta}{2}]\times[0; \frac{f(c)}{2}] \Rightarrow \int\limits_a^b f = \sigma(P_f) \ge \delta \cdot \frac{f(c)}{2} > 0$, противоречие.
            \end{proof}
    \end{enumerate}
\end{properties}
%END TICKET 04
\Subsection{Свойства интеграла}
%BEGIN TICKET 05
\begin{theorem}[Аддитивность интеграла]
    Пусть $f\!: [a, b] \to \R$,  $c \in [a, b]$.

    Тогда  $\int\limits_a^b f = \int\limits_a^c f + \int\limits_c^b f$.
\end{theorem}
\begin{proof}
	$\int\limits_a^b f = \sigma(P_{f_+}([a, b])) - \sigma(P_{f_-}([a, b]))$. Разделим наш $[a, b]$ и соответствующие множества вертикальной прямой $x=c$. Тогда $\sigma(P_{f_+}[a, b]) - \sigma(P_{f_-}[a, b]) = \sigma_{P_{f_+}[a, c]} + \sigma_{P_{f_+}[c, b]} - \sigma(P_{f_-}[a, c]) - \sigma(P_{f_-}[c, b]) = \int_a^c f + \int_c^b f$
\end{proof}
\begin{theorem}[Монотонность интеграла]
    Пусть $f, g\!: [a, b] \to \R$ и  $\forall x \in [a, b]\!: f(x) \le g(x)$.

    Тогда $\int\limits_a^b f \le \int\limits_a^b g$. 
\end{theorem}
\begin{proof}
    $f_+ = \max\{f, 0\} \le \max\{g, 0\} = g_+ \Rightarrow P_{f_+} \subset P_{g_+} \Rightarrow \sigma(P_{f_+}) \le \sigma(P_{g_+})$.

    $f_- = \max\{-f, 0\} \ge \max\{-g, 0\} = g_- \Rightarrow P_{f_-} \supset P_{g_-} \Rightarrow \sigma(P_{f_-}) \ge \sigma(P_{g_-})$.
    
    $\int\limits_a^b f = \sigma(P_{f_+}) - \sigma(P_{f_-}) \le \sigma(P_{g_+}) - \sigma(P_{g_-}) = \int\limits_a^b g$.
\end{proof}
\begin{consequence}
    \begin{enumerate}
        \item $|\int\limits_a^b f| \le \int\limits_a^b |f|$.
        \item $(b-a)\min\limits_{x \in [a, b]} f(x) \le \int\limits_a^b f \le (b-a)\max\limits_{x \in [a, b]} f(x)$.
    \end{enumerate}
\end{consequence}
\begin{proof}
    \begin{enumerate}
        \item $-|f| \le f \le |f| \Rightarrow$ (Применим теорему к двум неравенствам)
        
        $\int\limits_a^b -|f| \le \int\limits_a^b f \le \int\limits_a^b |f| \Rightarrow |\int\limits_a^b f| \le \int\limits_a^b |f|$.
	\item $m \coloneqq \min\limits_{x \in [a, b]} f(x)$,  $M \coloneqq \max\limits_{x \in [a, b]} f(x)$.  $m \le f(x) \le M \Rightarrow \int\limits_a^b m \le \int\limits_a^b f \le \int\limits_a^b M \Rightarrow$
	
	$m(b - a) \le \int\limits_a^b f \le M(b - a)$.
    \end{enumerate}
\end{proof}
\begin{theorem}[Интегральная теорема о среднем]
    Пусть $f \in C([a, b])$.

    Тогда  $\exists c \in (a, b)\!: \int\limits_a^b f = (b-a)f(c)$.
\end{theorem}
\begin{proof}
	$m \coloneqq \min f = f(p), M \coloneqq \max f = f(q)$ (по теореме Вейерштрасса). Тогда  $\frac{1}{b - a}\int\limits_a^b f = f(c) \Rightarrow f(p) \le \frac{1}{b-a}\int\limits_a^b f \le f(q) \xRightarrow{\text{т. Б-К}} \exists c \in (p, q)  \text{или $(q, p)$}\!: f(c) = \frac{1}{b - a}\int\limits_a^b f$.
\end{proof}
\begin{definition}
    $I_f \coloneqq \frac{1}{b-a} \int\limits_a^b f$ --- среднее значение $f$ на отрезке  $[a, b]$.
\end{definition}
%END TICKET 05
%BEGIN TICKET 06
\begin{definition}
    $f\!: [a, b] \to \R$. Интеграл с переменным верхним пределом  $\Phi(x) \coloneqq \int\limits_a^x f$, где  $x \in [a, b]$.
\end{definition}
\begin{definition}
    $f\!: [a, b] \to \R$. Интеграл с переменным нижним пределом  $\Psi(x) \coloneqq \int\limits_x^b f$, где  $x \in [a, b]$.
\end{definition}
\begin{remark}
    $\Phi(x) + \Psi(x) = \int\limits_a^b f$.
\end{remark}
\begin{theorem}[Теорема Барроу]
	Пусть  $f \in C([a, b])$. Тогда  $\Phi'(x) = f(x)\quad  \forall x \in[a, b]$. То есть  $\Phi$ --- первообразная функции  $f$.
\end{theorem}
\begin{proof}
	Надо доказать, что $\lim\limits_{y \to x} \frac{\Phi(y) - \Phi(x)}{y-x} = f(x)$. Проверим для предела справа (слева аналогично, но, возможно, с чуть другим порядком точек).

    Тогда $\Phi(y) - \Phi(x) = \int\limits_a^y f - \int\limits_a^x f = \int\limits_x^y f$.

    Тогда  $\frac{\Phi(y) - \Phi(x)}{y-x}=\frac{1}{y-x}\int\limits_x^y f = f(c)$ для некоторого $c \in (x, y)$ по интегральной теореме о среднем.

    Проверяем определение по Гейне. Берем  $y_n > x$ и  $y_n \to x$. Тогда  $\frac{\Phi(y_n)-\Phi(x)}{y_n - x} = f(c_n)$, где $c_n \in (x, y_n)$,  $x < c_n < y_n \to x \Rightarrow c_n \to x \Rightarrow$ в силу непрерывности $f$  $f(c_n) \to f(x)$.
\end{proof}
\begin{consequence}
    $\Psi'(x) = -f(x)\quad \forall x\in [a, b]$.
\end{consequence}
\begin{proof}
    $\Psi(x) = \int\limits_a^b f - \Phi(x) = C - \Phi(x) \Rightarrow \Psi' = (C - \Phi(x))' = -\Phi'(x) = -f(x)$.
\end{proof}
\begin{theorem}
    Непрерывная на промежутке функция имеет первообразную.
\end{theorem}
\begin{proof}
    $f\!: \langle a, b \rangle \to \R$. 

    Возьмём $c \in (a, b)$
    Рассмотрим  $F(x) \coloneqq \begin{cases} \int\limits_c^x f & \text{при } x \ge c \\ -\int\limits_x^c f & \text{при } x \le c \end{cases}$.

    Утверждаем, что $F(x)$ --- первообразная $f(x)$.
    Если $x > c$, то  $F'(x) = f(x)$. 
    Если $x < c$, то $F'(x) = -(-f(x)) = f(x)$
    Если $x = c$, то, так как производные слева и справа считаются правильно и равны, то и в этой точке производная есть $f(x)$.
\end{proof}

\begin{theorem}[Формула Ньютона-Лейбница]
    $f\!: [a, b] \to \R$ и  $F$ -- её первообразная. Тогда  $\int\limits_a^b f = F(b) - F(a)$.
\end{theorem}
\begin{proof}
	$\Phi(x) = \int\limits_a^x f$ --- первообразная и  $F(x) = \Phi(x) + C$ (знаем, что две первообразные отличаются на константу)

    Тогда  $F(b) - F(a) = (\Phi(b) + C) - (\Phi(a) + C) = \Phi(b) - \Phi(a) = \int\limits_a^b f$
\end{proof}

И ровно в этот момент мы поняли, что от выбора псевдоплощади не зависим, поскольку первообразные от них не зависят (отсылка к первому билету/началу конспекта про псевдоплощади)

\begin{definition}
    $F\mid_a^b \coloneqq F(b) - F(a)$
\end{definition}
%END TICKET 06
%BEGIN TICKET 07
\begin{theorem}[Линейность интеграла]
    $\int\limits_a^b(\alpha f + \beta g) = \alpha \int\limits_a^b f + \beta \int\limits_a^b g$.
\end{theorem}
\begin{proof}
    Пусть $F, G$ --- первообразные для  $f, g$.

    Тогда  $\alpha F + \beta G$ --- первообразная для  $\alpha f + \beta g$. Тогда воспользуемся формулой Ньютона-Лейбница:  \[
	    \int_a^b \alpha f + \beta g = \left.\left(\alpha F + \beta G\right)\right|_a^b = \alpha F(b) + \beta G(b) - \alpha F(a) - \beta G(a) = \alpha \int_a^b f + \beta \int_a^b g
    .\] 
\end{proof}
\begin{theorem}[Формула интегрирования по частям]
    Пусть $f, g \in C^{1}[a, b]$.

    Тогда  $\int\limits_a^b fg' = fg \mid_a^b - \int\limits_a^bf'g$.
\end{theorem}
\begin{proof}
    Докажем при помощи формулы Ньютона-Лейбница. Пусть $H$ --- первообразная  $f'g$. Тогда  $fg - H$ --- первообразная для $fg'$.

    Проверим данный факт: $\left(fg - H\right)' = f'g + fg' - f'g = fg'$. А значит нам можно воспользоваться формулой Ньютона-Лейбница.

    $\int\limits_a^b fg' = \left(fg - H\right) \mid_a^b = fg \mid_a^b - H\mid_a^b = fg\mid_a^b - \int_a^b f'g$.
\end{proof}

\begin{remark}[Соглашение]
    Если $a>b$, то  $\int\limits_a^b f \coloneqq -\int\limits_b^a f$.

    Мотивация: Если  $F$ --- первообразная, то  $\int\limits_a^b f = F \mid_a^b$.
\end{remark}
\begin{theorem}[Формула замены переменной]
    Пусть $f \in C[a, b]$, $\vphi\!: [c,d] \to [a,b]$, $\vphi \in C^1[c,d], p, q \in [c, d]$.

    Тогда  $\int\limits_p^q f(\vphi(t)) \vphi'(t) \mathrm{d}t = \int\limits_{\vphi(p)}^{\vphi(q)} f(x) \mathrm{d}x$.
\end{theorem}
\begin{proof}
    Пусть $F$ --- первообразная  $f$. Тогда  $\int\limits_{\vphi(p)}^{\vphi(q)}f(x) \mathrm{d}x = F \mid_{\vphi(p)}^{\vphi(q)} = F \circ \vphi\mid_p^q$. Заметим, что  $F \circ \vphi$ --- первообразная для  $f(\vphi(t))\vphi'(t)$.

    Проверим это:  $\left(F(\vphi(t))\right)' = F'(\vphi(t)) \cdot \vphi'(t) = f(\vphi(t))\vphi'(t)$.

    Тогда: $\int\limits_{\vphi(p)}^{\vphi(q)}f(x)\mathrm{d}x = \left.F \circ \vphi\right|_{\vphi(p)}^{\vphi(q)} =  \int\limits_{p}^qf(\vphi(t))\vphi'(t) \mathrm{d}t$
\end{proof}
\begin{example}
\begin{align}
    \int_0^{\frac{\pi}{2}} \frac{\sin 2t}{1 + \sin^4 t} \mathrm{d}t 
.\end{align}
Произведем замену $\vphi(t) = \sin^2 t$,  $f(x) = \frac{1}{1+x^2}$, $\vphi'(t) = 2 \sin t \cos t = \sin 2t$, $\vphi(0) = 0, \vphi(\frac{\pi}{2}) = 1$:
\begin{align*}
    (1) = \int_{0}^{\frac{\pi}{2}} \frac{\vphi'(t)}{1 + (\vphi(t))^2} = \int_{0}^{\frac{\pi}{2}}f(\vphi(t))\vphi'(t) \mathrm{d}t = \int_{\vphi(0)}^{\vphi(\frac{\pi}{2})} f(x)\mathrm{d}x = \int_{0}^{1}f(x)\mathrm{d}x = \int_0^1 \frac{\mathrm{d}x}{1+x^2} = \arctg x \mid_0^1 = \frac{\pi}{4}.
\end{align*}
\end{example}
%END TICKET 07
\Subsection{Приложения формулы интегрирования по частям}
%BEGIN TICKET 08
\begin{example}
    $W_n \coloneqq \int\limits_0^{\frac{\pi}{2}} \sin^n x \mathrm{d}x = \int\limits_0^{\frac{\pi}{2}}\cos^n t \mathrm{dt} = (1)$
    Докажем этот момент:

    Положим $x = \frac{\pi}{2} - t \eqqcolon \vphi(t)$, $\vphi'(t) = -1$,  $\sin(\frac{\pi}{2} - t) = \cos t$. 

    Тогда $(1) = -\int\limits_0^{\frac{\pi}{2}}\sin^n \vphi(t) \cdot \vphi'(t) \mathrm{d}t = \int\limits_{\frac{\pi}{2}}^0 \sin^n x \mathrm{d}x$

    Частные случаи $W_0 = \frac{\pi}{2}$, $W_1 = \int\limits_0^{\frac{\pi}{2}} \sin x \mathrm{d}x = -\cos \mid_0^{\frac{\pi}{2}} = 1$

    Общее решение: $W_n = \int\limits_0^{\frac{\pi}{2}} \sin^n x \mathrm{d}x = -\int\limits_0^{\frac{\pi}{2}} \sin^{n-1}x \cdot (\cos x)' \mathrm{d}x = (*)$. Воспользовались тем, что $\sin x = -(\cos x)'$, $f'(x) = (n-1)\sin^{n-2} x \cdot \cos x$. 

    Тогда получаем: \begin{align*} &(*) = -\left(\underbrace{\sin^{n-1} x \cdot \cos x \mid_0^{\frac{\pi}{2}}}_{=0} - \int\limits_0^{\frac{\pi}{2}} (n-1)\sin^{n-2} x \underbrace{\cos^2 x}_{=1-\sin^2 x} \mathrm{d} x\right) = \\ & =(n-1)\left(\int\limits_{0}^{\frac{\pi}{2}} \sin^{n-2} x \mathrm{d}x - \int\limits_{0}^{\frac{\pi}{2}} \sin^n x \mathrm{d} x\right) = (n-1)(W_{n-2} - W_n).
    \end{align*}

    Посчитаем для четных: $W_{2n} = \frac{2n-1}{2n} \cdot W_{2n-2} = \frac{2n-1}{2n} \cdot \frac{2n-3}{2n - 2} W_{2n-4} = \ldots = \frac{(2n-1)!!}{(2n)!!} \frac{\pi}{2}$, где $k!!$  --- произведение натуральных чисел   $\le k$ той же четности, что и  $k$ .

    Для нечетных: $W_{2n + 1} = \frac{2n}{2n+1} W_{2n-1} = \frac{2n}{2n+1} \cdot \frac{2n-2}{2n-1}W_{2n-3} = \ldots = \frac{(2n)!!}{(2n+1)!!}W_1 = \frac{(2n)!!}{(2n+1)!!}$
\end{example}
%END TICKET 08
%BEGIN TICKET 09
\begin{theorem}[Формула Валлиса]
    \[
        \lim_{n\to +\infty} \frac{(2n)!!}{(2n-1)!!} \cdot \frac{1}{\sqrt{2n+1}} = \sqrt{\frac{\pi}{2}}
    .\] 
\end{theorem}
\begin{proof}
    $\sin^n x \ge \sin^{n+1} x$ на $[0, \frac{\pi}{2}]$. Тогда $W_n = \int\limits_0^{\frac{\pi}{2}} \sin^n x \mathrm{d}x \ge \int\limits_0^{\frac{\pi}{2}} \sin^{n+1} x \mathrm{d}x = W_{n+1}$.

    Заметим, что $W_{2n+2} \le W_{2n+1} \le W_{2n} \iff \frac{\pi}{2}\frac{(2n+1)!!}{(2n+2)!!} \le \frac{(2n)!!}{(2n+1)!!} \le \frac{\pi}{2} \frac{(2n-1)!!}{(2n)!!}$. Поделим на $\frac{(2n-1)!!}{(2n)!!}$:  \[
        \frac{\pi}{2} \frac{2n+1}{2n+2} \le \frac{((2n)!!)^2}{(2n+1)((2n-1)!!)^2} \le \frac{\pi}{2} \implies \lim \left(\frac{(2n)!!}{\sqrt{(2n+1)}(2n-1)!!}\right)^2 = \frac{\pi}{2}
    .\] 

    Последний переход --- по двум милиционерам, т.к. при $n \to +\infty\ \  \frac{2n+1}{2n + 2} \to 1$
\end{proof}
\begin{consequence}
    \[
        \binom{2n}{n} = \frac{(2n)!}{(n!)^2} \sim \frac{4^n}{\sqrt{\pi n}}
    .\] 
\end{consequence}
\begin{proof}
    Заметим, что $(2n)! = (2n)!! \cdot (2n-1)!!$, а  $(2n)!! = 2 \cdot 4 \cdot 6 \cdot \ldots \cdot (2n) = 2^n \cdot n!$. Тогда подставим в Сшку: \[
        \binom{2n}{n} = \frac{(2n)!!(2n-1)!!}{\frac{(2n)!!}{2^n}\frac{(2n)!!}{2^n}} = 4^n \cdot \frac{(2n-1)!!}{(2n)!!}
    .\] 
    При этом из Валлиса, заметим, что $\frac{(2n)!!}{(2n-1)!!} \sim \sqrt{\frac{\pi}{2}} \sqrt{2n + 1} \sim \sqrt{\frac{\pi}{2}} \sqrt{2n} = \sqrt{\pi n}$. А значит все сойдется.
\end{proof}

%END TICKET 09
%BEGIN TICKET 10
\begin{theorem}[Формула Тейлора (с остатком в интегральной форме)]
    Пусть $f \in C^{n+1}[a, b]$,  $x, x_0 \in [a, b]$. Тогда: \[
        f(x) = \sum_{k=0}^n \frac{f^{(k)}(x_0)}{k!}(x-x_0)^k + \frac{1}{n!} \int\limits_{x_0}^x (x-t)^n f^{(n+1)}(t) \mathrm{d}t
    .\] 
\end{theorem}
\begin{proof}
    Индукция по $n$: 
    \begin{itemize}
        \item База. $n = 0$, $f(x) = f(x_0) + \int\limits_{x_0}^x f'(t)\mathrm{d}t = f(x_0)+f \mid_{x_0}^x$
        \item Переход. $n \to n + 1$.
        \item Доказательство.  $f(x) = T_n(x) + \frac{1}{n!}\int\limits_{x_0}^x \underbrace{(x-t)^n}_{g'} \underbrace{f^{(n+1)}(t)}_{f} \mathrm{d}t$. Проинтегрируем интеграл по частям. $g(t) = -\frac{(x-t)^{n+1}}{n+1}$. 

            Подставим: $\int\limits_{x_0}^x (x-t)^n f^{(n+1)}(t) \mathrm{d}t = -\frac{(x-t)^{n+1}}{n+1} \cdot f^{(n+1)}(t) \mid_{t=x_0}^{t=x} + \int_{x_0}^x \frac{1}{n+1} (x-t)^{n+1} \cdot f^{(n+2)}(t) \mathrm{d} t = \underbrace{\frac{1}{n+1}(x-x_0)^{n+1}f^{(n+1)}(x_0)}_{\text{новый член Тейлора!}} + \int_{x_0}^x \frac{1}{n+1} (x-t)^{n+1} \cdot f^{(n+2)}(t) \mathrm{d} t$

	    Вспомнив, что у нас там ещё был $\frac1{n!}$ перед исходным интегралом заметим, что мы действительно получили новый член суммы и новый интеграл с $\frac1{(n+1)!}$, что доказывает индукционный переход.
    \end{itemize}
\end{proof}
%END TICKET 10
%BEGIN TICKET 11
\begin{example}
    \begin{align}
    H_j \coloneqq \frac{1}{j!} \int\limits_0^{\frac{\pi}{2}}\left(\left(\frac{\pi}{2}\right)^2 - x^2\right)^j \cos x \mathrm{d}x.
    \end{align}
    \textbf{Свойство 1.} $0 < H_j \le \frac{1}{j!}\left(\frac{\pi}{2}\right)^{2j} \int\limits_0^{\frac{\pi}{2}} \cos x \mathrm{d}x = \frac{\left(\frac{\pi}{2}\right)^{2j}}{j!}$.\\
    \textbf{Свойство 2.} $\forall c > 0\!: c^j \cdot H_j \xrightarrow{j \to \infty} 0$.  $0 < c^j H_j \le \frac{\left(\frac{\pi}{2}\right)^{2j} \cdot c^j}{j!} = \frac{\left(\frac{\pi^2}{4}c\right)^j}{j!} \to 0$.\\
    \textbf{Свойство 3.} $H_0 = 1$,  $H_1 = 2$ (\textit{упражнение}).\\
    \textbf{Свойство 4.} $H_j = (4j - 2) H_{j-1} - \pi^2 H_{j-2}$, при  $j \ge 2$.
\end{example}
\begin{proof}

\begin{align}
    j! H_j = \int_0^{\frac{\pi}{2}} \left(\left(\frac{\pi}{2}\right)^2 - x^2\right)^j (\sin x)' \mathrm{d}x
\end{align}
Заметим, что $\left(\left(\left(\frac{\pi}{2}\right)^2 - x^2\right)^j\right)' = j \left(\left(\frac{\pi}{2}\right)^2 - x^2\right)^{j-1} \cdot (-2x)$. Тогда: {\small \begin{align*}
    (3) &= \underbrace{\left(\left( \frac{\pi}{2} \right)^2 - x^2\right)^j \sin x \mid_{x = 0}^{x = \frac{\pi}{2}}}_{=0} + 2j \int_{0}^{\frac{\pi}{2}}\left(\left(\frac{\pi}{2}\right)^2 - x^2\right)^{j-1} x \underbrace{\sin x}_{=(-\cos x)'} \mathrm{d} x = \\
	&= 2j \left(\underbrace{\left(\left(\frac{\pi}{2}\right)^2 - x^2\right)^{j-1} \cdot x \cdot (- \cos x) \mid_{x=0}^{x=\frac{\pi}{2}}}_{=0}\right. - \\ 
    &- \left.\int\limits_0^{\frac{n}{2}} \left( (j-1)\left( \left(\frac{\pi}2 \right)^2 - x^2  \right)^{j-2}(-2x)x + \left( \left(\frac{\pi}2 \right)^2 - x^2  \right)^{j-1}  \right)(-\cos x)  \mathrm{d}x \right) \\
	&= 2j\left( (j-1)!H_{j-1} - 2(j-1)\int_0^{\frac{\pi}2} \left( \left( \frac{\pi}2\right)^2 - x^2  \right)^{j-2}x^2 \cos x dx \right)
.\end{align*} }
В процессе мы дважды интегрировали по частям, а теперь нужно избавиться во втором слагаемом от $x^2$. Для этого заметим, что $x^2 = \left( \frac{\pi}2 \right)^2 - \left( \left( \frac{\pi}2 \right)^2 - x^2  \right)$, подставим и разобьём интеграл на два, которые есть $H_{j-2}$ и $H_{j-1}$ с нужными коэффициентами:

$$
j! H_j = 2j(j-1)! H_{j-1} - 4j(j-1)\left(((j-2)!\left( \frac{\pi}2  \right)^2) H_{j-2} - (j-1)! H_{j-1} \right)
$$

Откуда с легкостью получаем $j! H_j = 2j! H_{j-1} - \pi^2 j! H_{j-2} + 4(j-1)j! H_{j-1} \iff H_j = (4j-2)H_{j-1} - \pi^2 H_{j-2}$.\\
\textbf{Свойство 5.} Существует многочлен $P_n$ с целыми коэффициентами степени $\le n$, такой что $H_j = P_j(\pi^2)$.
\begin{proof}
    $P_0 \equiv 1, P_1 \equiv 2, P_n(x) = (4n-2)P_{n-1}(x) - xP_{n-2}(x)$.
\end{proof}
\end{proof}
\begin{theorem}[Ламберта, доказательство: Эрмит]
    Числа $\pi$ и  $\pi^2$ иррациональные.
\end{theorem}
\begin{proof}
    От противного. Пусть $\pi^2$ --- рационально. Тогда пусть  $\pi^2 = \frac{m}{n}$. Тогда $H_j = P_j(\frac{m}{n}) = \frac{\text{целое число}}{n^j} > 0$.\\
    $n^j H_j = \text{целое число} > 0 \Rightarrow n^j H_j \ge 1$

    Но, по свойству 2, при $j \to +\infty\ \ n^j H_j \to 0$, противоречие.
\end{proof}
%END TICKET 11
